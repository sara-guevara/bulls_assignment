tidy(fit2, conf.int = TRUE)
summary(fit2)
fit2_mp <- lm(PTS_pmp ~ AST_pmp + FG_pmp + x3P_pmp + x2P_pmp + FT_pmp, data = filtered_df)
tidy(fit2_mp, conf.int = TRUE)
summary(fit2_mp)
summary(fit2_mp)
res <- residuals(fit_pg)
fitted <- predic(fit_pg)
ggplot(data = NULL, aes(x = fitted, y = res)) +
geom_point(colour = "dodgerblue") +
geom_hline(yintercept = 0, colour = "red", linetype = "dashed")
cook <- cooks.distance(fit_pg)
cook_labels <- if_else(cook >= 0.1, paste(points), "")
ggplot(data = NULL, aes(x = points, y = cook)) +
geom_point() +
geom_text(aes(label = cook_labels), nudge_y = 0.02)
cook_mp <- cooks.distance(fit_mp)
cook_labels_mp <- if_else(cook_mp >= 0.075, paste(points), "")
ggplot(data = NULL, aes(x = points_mp, y = cook_mp)) +
geom_point() +
geom_text(aes(label = cook_labels_mp), nudge_y = 0.005)
filtered_df <- df_team %>%
filter(!Rk %in% outliers)
fit2_mp <- lm(PTS_pmp ~ AST_pmp + FG_pmp + x3P_pmp + x2P_pmp + FT_pmp, data = filtered_df)
tidy(fit2_mp, conf.int = TRUE)
res <- residuals(fit_pg)
fitted <- predic(fit_pg)
fitted <- predict(fit_pg)
ggplot(data = NULL, aes(x = fitted, y = res)) +
geom_point(colour = "dodgerblue") +
geom_hline(yintercept = 0, colour = "red", linetype = "dashed")
res_mp <- residuals(fit_mp)
fitted_mp <- predict(fit_mp)
ggplot(data = NULL, aes(x = fitted_mp, y = res_mp)) +
geom_point(colour = "dodgerblue") +
geom_hline(yintercept = 0, colour = "red", linetype = "dashed")
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth = 4)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth = 10)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth = 20)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth = 3)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth = 3)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth =30)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidgth =30)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", bindwidth =30)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth =30)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth =4)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.01)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.1)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 1)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.5)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.3)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.4)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.45)
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.5)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.5)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.005)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.0005)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.001)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.005)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.001)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.004)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.003)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.002)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.0015)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.002)
ggplot(data = NULL, aes(sample = res)) +
stat_qq() + stat_qq_line()
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line()
res_mp2 <- residuals(fit_mp2)
res_mp2 <- residuals(fit2_mp)
fitted_mp2 <- predict(fit2_mp)
ggplot(data = NULL, aes(sample = res_mp2)) +
stat_qq() + stat_qq_line()
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.05, 0.05))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.025, 0.025))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.01, 0.01))
ggplot(data = NULL, aes(sample = res_mp2)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.01, 0.01))
ggplot(data = NULL, aes(sample = res_mp2)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.005, 0.005))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.05, 0.05))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.01, 0.01))
fit_mp <- lm(PTS_pmp ~ AST_pmp + x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
summary(fit_mp)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.002)
res_mp <- residuals(fit_mp)
res_mp2 <- residuals(fit2_mp)
fitted_mp <- predict(fit_mp)
fitted_mp2 <- predict(fit2_mp)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.002)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.001)
fit_mp <- lm(PTS_pmp ~ AST_pmp + FG_mp + x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
AST_pmp + FG_mp +
AST_pmp + FG_mp +
fit_mp <- lm(PTS_pmp ~ AST_pmp + FG_mp + x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
fit_mp <- lm(PTS_pmp ~ AST_pmp + FG_mp + x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
fit_mp <- lm(PTS_pmp ~ AST_pmp + FG_pmp + x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
fit_mp <- lm(PTS_pmp ~  FG_pmp + x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
fit_mp <- lm(PTS_pmp ~   x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
summary(fit_mp)
car::durbinWatsonTest(fit_mp)
car::avPlots(fit_mp)
std_res_mp <- rstandard(fit_mp)
points_mp <- 1:length(std_res_mp)
res_labels_mp <- if_else(abs(std_res_mp) >= 2, paste(points_mp), "")
ggplot(data = NULL, aes(x = points_mp, y = std_res_mp, label = res_labels_mp)) +
geom_point() +
ylim(c(-4,4)) +
geom_text(nudge_x = 0.5 ) +
geom_hline(yintercept = c(-3,3), colour = "red", linetype = "dashed")
hats_mp <- hatvalues(fit_mp)
hats_labels_mp <- if_else(hats_mp >= 0.3, paste(points), "")
ggplot(data = NULL, aes(x = points_mp, y = hats_mp)) +
geom_point() +
geom_text(aes(label = hats_labels_mp), nudge_y = 0.02)
cook_mp <- cooks.distance(fit_mp)
cook_labels_mp <- if_else(cook_mp >= 0.075, paste(points), "")
ggplot(data = NULL, aes(x = points_mp, y = cook_mp)) +
geom_point() +
geom_text(aes(label = cook_labels_mp), nudge_y = 0.005)
ggplot(data = NULL, aes(x = points_mp, y = cook_mp)) +
geom_point() +
geom_text(aes(label = cook_labels_mp), nudge_y = 0.008)
ggplot(data = NULL, aes(x = points_mp, y = cook_mp)) +
geom_point() +
geom_text(aes(label = cook_labels_mp), nudge_y = 0.01)
outliers <- c(5, 11, 16, 26 )
filtered_df <- df_team %>%
filter(!Rk %in% outliers)
fit2_mp <- lm(PTS_pmp ~ AST_pmp + FG_pmp + x3P_pmp + x2P_pmp + FT_pmp, data = filtered_df)
tidy(fit2_mp, conf.int = TRUE)
fit2_mp <- lm(PTS_pmp ~ x3P_pmp + x2P_pmp + FT_pmp, data = filtered_df)
tidy(fit2_mp, conf.int = TRUE)
summary(fit2_mp)
res_mp <- residuals(fit_mp)
res_mp2 <- residuals(fit2_mp)
fitted_mp <- predict(fit_mp)
fitted_mp2 <- predict(fit2_mp)
ggplot(data = NULL, aes(x = fitted_mp, y = res_mp)) +
geom_point(colour = "dodgerblue") +
geom_hline(yintercept = 0, colour = "red", linetype = "dashed")
ggplot(data = NULL, aes(x = res)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.5)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.001)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.005)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.004)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.003)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.002)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.001)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.0045)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.003)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.0025)
ggplot(data = NULL, aes(x = res_mp)) +
geom_histogram(colour = "black", fill = "dodgerblue", binwidth = 0.0045)
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.01, 0.01))
ggplot(data = NULL, aes(sample = res_mp2)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.005, 0.005))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.005, 0.005))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.005, 0.005))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line() +
ylim(c(-0.005, 0.005))
ggplot(data = NULL, aes(sample = res_mp)) +
stat_qq() + stat_qq_line()
pairs(formula(= ~ AST_per_game + x3P_per_game + x2P_per_game + FT_per_game, data = df_team))
pairs(formula= ~ AST_per_game + x3P_per_game + x2P_per_game + FT_per_game, data = df_team))
pairs(formula= ~ AST_per_game + x3P_per_game + x2P_per_game + FT_per_game, data = df_team)
pairs(formula= ~ x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
car::vif(fit_pg)
car::vif(fit_mp)
car::vif(fit_mp2)
car::vif(fit2_mp)
car::vif(fit_mp)
car::vif(fit2_mp)
car::vif(fit_mp)
head(predict(fit_mp))
head(predict(fit2_mp))
head(predict(fit_mp))
summary(fit_mp)
new_dat <- mutate(dt_team, exp_PTS_per_game = predict(fit_mp, newdata = new_dat))
new_dat <- mutate(df_team, exp_PTS_per_game = predict(fit_mp, newdata = new_dat))
new_dat <- mutate(df_team, exp_PTS_per_game = predict(fit_mp, newdata = df_team))
new_dat <- mutate(PW, exp_PTS_per_game = predict(fit_mp, newdata = df_team))
new_dat <- mutate(new_dat, exp_PTS_per_game = predict(fit_mp, newdata = df_team))
exp_PTS_pmp = predict(fit_mp)
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.1, cex = 3) +
geom_abline(linetype = "dashed", colour = "magenta")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.0011, cex = 3) +
geom_abline(linetype = "dashed", colour = "magenta")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.001, cex = 3) +
geom_abline(linetype = "dashed", colour = "magenta")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.01, cex = 3) +
geom_abline(linetype = "dashed", colour = "magenta")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "magenta")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "magenta")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red")
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = 20  )
coef(lm(PW ~ exp_PTS_pmp, data = df_team))
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -171, slope = 460.8762  )
coef(lm(W ~ exp_PTS_pmp, data = df_team)) # used this to find the slope and coefficient of these two variables
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -171, slope = 460.8762  )
ggplot(df_team, aes(exp_PTS_pmp, W, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
setwd("H:/repos/bulls_assignment")
knitr::opts_chunk$set(echo = TRUE)
mp_per_game <- df_team %>%
group_by(Team) %>%
pull(mp_per_game) %>%
mean
mp_per_game <- df_team %>%
group_by(Team) %>%
summarise(mp_per_game = MP/G) %>%
pull(mp_per_game) %>%
mean
mp_per_game
mp_per_game <- df_team %>%
group_by(Team) %>%
summarise(mp_per_game = MP/G /5) %>%
pull(mp_per_game) %>%
mean
mp_per_game
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', x3PAr = "3PAr", TSp = "TS%", eFGp = "eFG%", TOVp = "TOV%", ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', TSp = "TS%", eFGp = "eFG%", TOVp = "TOV%", ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', eFGp = "eFG%", TOVp = "TOV%", ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', eFGp = "eFG%" , ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', eFGp = "eFG%", ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', eFGp = "eFG%")
play_ave <- stat_pl %>%
summarise(play_ave = MP / mp_per_game)
play_ave <- stat_pl %>%
summarise(play_ave = MP / mp_per_game) %>%
pull(play_ave) %>%
mean
play_ave <- stat_pl & df_team %>%
summarise(play_ave = MP / mp_per_game) %>%
pull(play_ave) %>%
mean
df_player <- right_join(x = df_player,
y = df_team(select(mp_per_game)))
df_player <- right_join(x = df_player,
y = df_team(mp_per_game))
mp_per_game <- df_team %>%
group_by(Team) %>%
mutate(mp_per_game = MP / G/5) %>%
summarise(mp_per_game = MP/G /5) %>%
pull(mp_per_game) %>%
mean
mp_per_game
df_player <- right_join(x = df_player,
y = df_team(mp_per_game))
y = df_team(select(mp_per_game))
players <- stat_pl %>%
group_by(player_name) %>%
mutate(play_ave = MP / mp_per_game,
PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
players <- df_player %>%
group_by(player_name) %>%
mutate(play_ave = MP / mp_per_game,
PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
View(df_player)
players <- df_player %>%
group_by(player_name) %>%
mutate(play_ave = MP / mp_per_game,
PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(play_ave = MP / mp_per_game,
PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(play_ave = MP / mp_per_game,
PTS_pmp = PTS / mp_per_game,
x3P_pmp = x3P / mp_per_game,
x2P_pmp = x2P / mp_per_game,
FT_pmp = FTA / mp_per_game)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(play_ave = MP / mp_per_game,
PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
play_ave <- stat_pl & df_team %>%
summarise(play_ave = MP / mp_per_game) %>%
pull(play_ave) %>%
mean
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FTA_pmp * mp_per_game)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
select(c(x3P_n, x2P_n, FT_n, player_name, Pos))
View(player)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
select(c(player_name, Pos, x3P_n, x2P_n, FT_n ))
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
select(c(player_name, Pos, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp))
Player <- mutate(players, exp_PTS_pmp = predict(fit_mp, newdata = players))
Player <- mutate(player, exp_PTS_pmp = predict(fit_mp, newdata = players))
Player <- mutate(player, exp_PTS_pmp = predict(fit_mp, newdata = player))
Player <- mutate(player, exp_PTS_p_pl = predict(fit_mp, newdata = player))
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
select(c(player_name, Pos, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
Player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
fit_mp <- lm(PTS_pmp ~   x3P_pmp + x2P_pmp + FT_pmp, data = player)
fit_mp_pl <- lm(PTS_pmp ~   x3P_pmp + x2P_pmp + FT_pmp, data = player)
tidy(fit_mp_pl, conf.int = TRUE)
Player <- mutate(player, exp_PTS_ppl = predict(fit_mp_pl, newdata = player))
exp_PTS_ppl = predict(fit_mp_pl)
player <- mutate(player, exp_PTS_ppl = predict(fit_mp_pl, newdata = player))
fit_mp_pl <- lm(PTS_pmp ~   x3P_n + x2P_n + FT_n, data = player)
tidy(fit_mp_pl, conf.int = TRUE)
exp_PTS_ppl = predict(fit_mp_pl)
player <- mutate(player, exp_PTS_ppl = predict(fit_mp_pl, newdata = player))
predict
fit_mp_pl <- lm(PTS_pmp ~   x3P_pmp + x2P_pmp + FT_pmp, data = player)
tidy(fit_mp_pl, conf.int = TRUE)
head(predict(fit_mp_pl))
player <- mutate(player, exp_PTS_ppl = predict(fit_mp_pl, newdata = player))
player <- mutate(player, exp_ppl = predict(fit_mp_pl, newdata = player))
predict <- mutate(player, exp_ppl = predict(fit_mp_pl, newdata = player))
fit_mp_pl <- lm(PTS_n ~   x3P_n + x2P_n + FT_n, data = player)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
select(c(player_name, Pos, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
fit_mp_pl <- lm(PTS_n ~   x3P_n + x2P_n + FT_n, data = player)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
fit_mp_pl <- lm(PTS_n ~ x3P_n + x2P_n + FT_n, data = player)
tidy(fit_mp_pl, conf.int = TRUE)
exp_PTS_ppl = predict(fit_mp_pl)
head(predict(fit_mp_pl))
predict <- mutate(player, exp_ppl = predict(fit_mp_pl, newdata = player))
predict <- predict(fit_mp_pl, newdata = player))
predict <- predict(fit_mp_pl, newdata = player)
str(predict)
predict <- player %>%
mutate(plyr_value = predict(fit_mp_pl, newdata = player))
predict <- player %>%
mutate(plyr_value = predict(fit_mp_pl))
