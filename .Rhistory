car::vif(fit_mp)
head(predict(fit_mp))
summary(fit_mp)
exp_PTS_pmp = predict(fit_mp)
coef(lm(PW ~ exp_PTS_pmp, data = df_team)) # used this to find the slope and coefficient of these two variables
ggplot(df_team, aes(exp_PTS_pmp, PW, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -171, slope = 460.8762  )
exp_PTS_pmp = predict(fit_mp)
coef(lm(W ~ exp_PTS_pmp, data = df_team)) # used this to find the slope and coefficient of these two variables
ggplot(df_team, aes(exp_PTS_pmp, W, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
knitr::opts_chunk$set(echo = TRUE)
df_team <- left_join(x = stat_tm2, y = stat_tm1 [-c(1,3, 23:25)],
by = "Team")
df_team <- df_team %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', x3PAr = "3PAr", TSp = "TS%", eFGp = "eFG%", TOVp = "TOV%", ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_team <- df_team %>%
mutate (PTS_per_game = PTS / G,
WINp = W/G,
AST_per_game = AST / G,
FG_per_game = FGA / G,
x3P_per_game = x3P / G,
x2P_per_game = x2PA / G,
FT_per_game = FTA / G,
STL_per_game = STL / G,
BLK_per_game = BLK / G,
TOV_per_game = TOV / G,
ORB_per_game = ORB / G,
DRB_per_game = DRB / G,
TRB_per_game = TRB / G,
PF_per_game = PF / G)
df_team <- df_team %>%
mutate (PTS_pmp = PTS / MP ,
AST_pmp = AST / MP,
FG_pmp = FGA / MP,
x3P_pmp = x3P / MP ,
x2P_pmp = x2P / MP ,
FT_pmp = FTA / MP,
STL_pmp = STL / MP ,
BLK_pmp = BLK / MP,
TOV_pmp = TOV / MP,
ORB_pmp = ORB / MP,
DRB_pmp = DRB / MP,
TRB_pmp = TRB / MP,
PF_pmp = PF / MP)
fit_mp <- lm(PTS_pmp ~   x3P_pmp + x2P_pmp + FT_pmp, data = df_team)
tidy(fit_mp, conf.int = TRUE)
df_player <- stat_pl %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', eFGp = "eFG%")
mp_per_game <- df_team %>%
group_by(Team) %>%
summarise(mp_per_game = MP/G /5) %>%
pull(mp_per_game) %>%
mean
mp_per_game
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
filter(PTS_n > 10) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
player <- df_player %>%
summarise(MPn = sum(MP)/mp_per_game,
x3P_pmp = sum(x3P_pmp)/ MPn,
x2P_pmp = sum(x2P_pmp)/MPn,
FT_pmp = sum(FT_pmp) / MPn,
G = sum(G)) %>%
filter(G > 20) %>%
select(-c(MPn))
head(player)
player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
player %>%
ggplot(aes(x = exp_PTS_ppl)) +
geom_histogram(binwidth = 0.01, colour = "black", fill = "blue")
player <- sal %>%
select(player_name, salary) %>%
right_join(player, by = "player_name")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(broom)
View(pay)
View(pay)
pos <- df_player %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
pos <- df_player %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G))
pos <- df_player %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G))
View(pos)
player <- df_player %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
View(player)
pos <- df_player %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
View(player)
View(pos)
player <- pos %>%
select(player_name) %>%
right_join(player, by = "player_name")
View(player)
player <- sal %>%
select(player_name, salary) %>%
right_join(player, by = "player_name")
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
filter(PTS_n > 10) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
player <- df_player %>%
summarise(MPn = sum(MP)/mp_per_game,
x3P_pmp = sum(x3P_pmp)/ MPn,
x2P_pmp = sum(x2P_pmp)/MPn,
FT_pmp = sum(FT_pmp) / MPn,
G = sum(G)) %>%
filter(G > 20) %>%
select(-c(MPn))
head(player)
player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
player %>%
ggplot(aes(x = exp_PTS_ppl)) +
geom_histogram(binwidth = 0.01, colour = "black", fill = "blue")
player <- sal %>%
select(player_name, salary) %>%
right_join(player, by = "player_name")
View(player)
?top_n
pos <- df_player %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
pos <- df_player %>%
filter(G > 20) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- pos %>%
select(player_name) %>%
right_join(player, by = "player_name")
View(player)
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
filter(! is.na(Pos) & !is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
filter(!is.na(Pos) & !is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
filter(!is.na(Pos) & !is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- filter(!is.na(Pos) & !is.na(salary))
a
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- filter( !is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- filter(player, !is.na(Pos) & !is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- player %>%
filter(!is.na(Pos) & !is.na(salary))
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary) %>%
top_n(25)
player <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary) %>%
top_n(25)
player <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
mp_per_game <- df_team %>%
group_by(Team) %>%
summarise(mp_per_game = MP/G) %>%
pull(mp_per_game) %>%
mean
mp_per_game <- df_team %>%
group_by(Team) %>%
summarise(mp_per_game = MP/G/5) %>%
pull(mp_per_game) %>%
mean
mp_per_game
df_player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_pmp = PTS / MP,
x3P_pmp = x3P / MP,
x2P_pmp = x2P / MP,
FT_pmp = FTA / MP)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
filter(PTS_n > 10) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
filter(PTS_n > 10) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
player <- df_player %>%
summarise(MPn = sum(MP)/mp_per_game,
x3P_pmp = sum(x3P_pmp)/ MPn,
x2P_pmp = sum(x2P_pmp)/MPn,
FT_pmp = sum(FT_pmp) / MPn,
G = sum(G)) %>%
filter(G > 20) %>%
select(-c(MPn))
head(player)
player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
player %>%
ggplot(aes(x = exp_PTS_ppl)) +
geom_histogram(binwidth = 0.01, colour = "black", fill = "blue")
player <- sal %>%
select(player_name, salary) %>%
right_join(player, by = "player_name")
pos <- df_player %>%
filter(G > 20) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
```{r nas}
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
pos <- df_player %>%
filter(G > 20) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
View(player)
pos <- df_player %>%
filter(G > 20) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
filter(PTS_n > 10) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
player <- df_player %>%
summarise(MPn = sum(MP)/mp_per_game,
x3P_pmp = sum(x3P_pmp)/ MPn,
x2P_pmp = sum(x2P_pmp)/MPn,
FT_pmp = sum(FT_pmp) / MPn,
G = sum(G)) %>%
filter(G > 20) %>%
select(-c(MPn))
head(player)
player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
player %>%
ggplot(aes(x = exp_PTS_ppl)) +
geom_histogram(binwidth = 0.01, colour = "black", fill = "blue")
player <- sal %>%
select(player_name, salary) %>%
right_join(player, by = "player_name")
pos <- df_player %>%
filter(G > 20) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
View(player)
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
View(player)
View(player)
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name") %>%
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
player_choices <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
player <- df_player %>%
group_by(player_name) %>%
mutate(PTS_n = PTS_pmp * mp_per_game,
x3P_n = x3P_pmp * mp_per_game,
x2P_n = x2P_pmp * mp_per_game,
FT_n = FT_pmp * mp_per_game) %>%
filter(PTS_n > 10) %>%
select(c(player_name, Pos, PTS_n, x3P_n, x2P_n, FT_n, x3P_pmp, x2P_pmp, FT_pmp, PTS_pmp))
player <- df_player %>%
summarise(MPn = sum(MP)/mp_per_game,
x3P_pmp = sum(x3P_pmp)/ MPn,
x2P_pmp = sum(x2P_pmp)/MPn,
FT_pmp = sum(FT_pmp) / MPn,
G = sum(G)) %>%
filter(G > 20) %>%
select(-c(MPn))
player <- mutate(player, exp_PTS_ppl = predict(fit_mp, newdata = player))
player %>%
ggplot(aes(x = exp_PTS_ppl)) +
geom_histogram(binwidth = 0.01, colour = "black", fill = "blue")
player <- sal %>%
select(player_name, salary) %>%
right_join(player, by = "player_name")
pos <- df_player %>%
filter(G > 20) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player_choices <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
View(player)
View(player)
View(player_choices)
pos <- df_player %>%
filter(GS > 0) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(GS)) %>%
top_n(1,abs(GS))
pos <- df_player %>%
filter(GS > 0) %>%
group_by(player_name, Pos) %>%
summarise(GS = sum(GS)) %>%
top_n(1,abs(GS))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player_choices <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
pos <- df_player %>%
filter(G > 0) %>%
group_by(player_name, Pos) %>%
summarise(G = sum(G)) %>%
top_n(1,abs(G))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player <- pos %>%
select(player_name, Pos) %>%
right_join(player, by = "player_name")
player <- player %>%
filter(!is.na(Pos)) %>%
filter(!is.na(salary))
player_choices <- player %>%
select(player_name, Pos, salary, exp_PTS_ppl) %>%
arrange(desc(exp_PTS_ppl), salary)
setwd("H:/repos/bulls_assignment")
write.csv(df_team,file = "data/processed/df_team.csv", row.names = FALSE)
write.csv(df_player,file = "data/processed/df_player.csv", row.names = FALSE)
write.csv(filtered_df,file = "data/processed/filtered_df.csv", row.names = FALSE)
write.csv(pay,file = "data/processed/bulls_pay.csv", row.names = FALSE)
write.csv(player,file = "data/processed/player.csv", row.names = FALSE)
write.csv(player_choices,file = "data/processed/player_choices.csv", row.names = FALSE)
write.csv(pos,file = "data/processed/pos.csv", row.names = FALSE)
write.csv(sal,file = "data/processed/sal.csv", row.names = FALSE)
write.csv(stat_pl,file = "data/processed/stat_pl.csv", row.names = FALSE)
write.csv(stat_tm1, file = "data/processed/stat-tm1.csv", row.names = FALSE)
write.csv(stat_tm2, file = "data/processed/stat_tm2.csv", row.names = FALSE)
ggplot(df_team, aes(exp_PTS_pmp, W, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, nudge_y = 5, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
ggplot(df_team, aes(exp_PTS_pmp, W, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, nudge_y = 1, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
ggplot(df_team, aes(exp_PTS_pmp, W, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.01, nudge_y = 1, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
ggplot(df_team, aes(exp_PTS_pmp, W, label = Team)) +
geom_point(colour = "dodgerblue") +
geom_text(nudge_x = 0.005, nudge_y = 1, cex = 3) +
geom_abline(linetype = "dashed", colour = "red", intercept = -177, slope = 475.6097  )
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(broom)
df_team <- df_team %>%
rename( x3P = '3P', x3PA = '3PA', x3Pp = '3P%', x2P = '2P', x2PA = '2PA', x2Pp = '2P%', FGp = 'FG%', FTp = 'FT%', x3PAr = "3PAr", TSp = "TS%", eFGp = "eFG%", TOVp = "TOV%", ORBp = "ORB%", FT_per_FGA = "FT/FGA", DRBp = "DRB%")
df_team <- df_team %>%
mutate (PTS_per_game = PTS / G,
WINp = W/G,
AST_per_game = AST / G,
FG_per_game = FGA / G,
x3P_per_game = x3P / G,
x2P_per_game = x2PA / G,
FT_per_game = FTA / G,
STL_per_game = STL / G,
BLK_per_game = BLK / G,
TOV_per_game = TOV / G,
ORB_per_game = ORB / G,
DRB_per_game = DRB / G,
TRB_per_game = TRB / G,
PF_per_game = PF / G)
lm_teams_pg <- lm(PTS_per_game ~ AST_per_game + FG_per_game + x3P_per_game + x2P_per_game + FT_per_game, data = df_team)
tidy(lm_teams_pg, conf.int = TRUE)
lm_teams_pg <- lm(PTS_per_game ~ AST_per_game + x3P_per_game + x2P_per_game + FT_per_game, data = df_team)
lm_teams <- lm(PTS_per_game ~ AST_per_game + FG_per_game + x3P_per_game + x2P_per_game + FT_per_game + STL_per_game + BLK_per_game + TOV_per_game + DRB_per_game + ORB_per_game, data = df_team)
tidy(lm_teams, conf.int = TRUE)
summary(lm_teams)
car::durbinWatsonTest(lm_teams_pg)
car::avPlots(lm_teams_pg)
car::avPlots(lm_teams)
